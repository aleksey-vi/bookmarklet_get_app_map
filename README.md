# bookmarklet_get_app_map

Essentially, this is just a bookmark in your browser. When clicked, it runs JavaScript code that maps the application, filters out unnecessary data, and may even highlight something interesting.

## Code Block
```
javascript:(async function(){let scanningDiv=document.createElement("div");scanningDiv.style.position="fixed";scanningDiv.style.bottom="0";scanningDiv.style.left="0";scanningDiv.style.width="100%";scanningDiv.style.maxHeight="50%";scanningDiv.style.overflowY="scroll";scanningDiv.style.backgroundColor="white";scanningDiv.style.color="black";scanningDiv.style.padding="10px";scanningDiv.style.zIndex="9999";scanningDiv.style.borderTop="2px solid black";scanningDiv.innerHTML="<h4>Scanning...</h4>";document.body.appendChild(scanningDiv);let visited=new Set(),allLinks=[],maxLinks=5000,baseDomain=window.location.origin;async function fetchWithTimeout(url,timeout){try{return await Promise.race([fetch(url,{headers:{Referer:window.location.href}}),new Promise((_,reject)=>setTimeout(()=>{reject(new Error(`Timeout fetching ${url}`))},timeout))]);}catch(e){console.error(`Fetch error for ${url}: ${e.message}`);return null;}}async function crawl(url){if(visited.has(url)||allLinks.length>=maxLinks)return;visited.add(url);let response=await fetchWithTimeout(url,5000);if(!response || !response.ok){console.error(`Skipping ${url} due to fetch failure: ${response ? response.status : %27No response%27}`);return;}let text=await response.text();let parser=new DOMParser();let doc=parser.parseFromString(text,"text/html");let links=doc.querySelectorAll("a[href]");let scripts=doc.querySelectorAll("script[src]");for(let link of links){let href=link.getAttribute("href");if(href && !visited.has(href) && !href.match(/\.(bmp|ico|css|woff|woff2|webp)/i) && allLinks.length<maxLinks){let fullUrl=new URL(href,baseDomain).href;console.log(`Raw href: ${href}, Converted to: ${fullUrl}`);allLinks.push(fullUrl);console.log(`Added link: ${fullUrl}, Total: ${allLinks.length}`);}}for(let script of scripts){let src=script.getAttribute("src");if(src && !visited.has(src) && !src.match(/\.(bmp|ico|css|woff|woff2|webp)/i) && allLinks.length<maxLinks){let fullSrc=new URL(src,baseDomain).href;console.log(`Raw src: ${src}, Converted to: ${fullSrc}`);allLinks.push(fullSrc);console.log(`Added JS link: ${fullSrc}, Total: ${allLinks.length}`);}}for(let link of links){let href=link.getAttribute("href");if(href && !href.match(/\.(bmp|ico|css|woff|woff2|webp)/i) && allLinks.length<maxLinks){let fullUrl=new URL(href,baseDomain).href;await crawl(fullUrl);}}}let initialLinks=Array.from(document.querySelectorAll("a[href]")).map(a=>{let href=a.getAttribute("href");if(href){let fullUrl=new URL(href,baseDomain).href;console.log(`Initial raw href: ${href}, Converted to: ${fullUrl}`);return fullUrl;}return %27%27;}).filter(href=>href);for(let link of initialLinks){if(!visited.has(link)){await crawl(link);}}let baseHostname=(new URL(baseDomain)).hostname.replace(/^www\./,"");let resultsInScope=allLinks.filter(href=>{try{let url=new URL(href);let hostname=url.hostname.replace(/^www\./,"");return hostname===baseHostname;}catch(e){return false;}});let resultsSubdomains=allLinks.filter(href=>{try{let url=new URL(href);let hostname=url.hostname.replace(/^www\./,"");let baseParts=baseHostname.split(%27.%27);let domainParts=hostname.split(%27.%27);if(domainParts.slice(-baseParts.length).join(%27.%27)===baseParts.join(%27.%27)&&hostname!==baseHostname){return true;}return false;}catch(e){return false;}}).map(href=>{try{let url=new URL(href);return url.origin+"/";}catch(e){return href;}}).filter((value, index, self)=>self.indexOf(value)===index);let resultsOutOfScope=allLinks.filter(href=>{try{let url=new URL(href);let hostname=url.hostname.replace(/^www\./,"");let baseParts=baseHostname.split(%27.%27);let domainParts=hostname.split(%27.%27);return domainParts.slice(-baseParts.length).join(%27.%27)!==baseParts.join(%27.%27);}catch(e){return false;}});let jsFiles=allLinks.filter(href=>{try{let url=new URL(href);let hostname=url.hostname.replace(/^www\./,"");console.log(`Checking JS: ${href}, Host: ${hostname}, Base: ${baseHostname}`);return href.match(/\.js/) && (hostname===baseHostname || hostname.endsWith(%27.%27 + baseHostname));}catch(e){console.error(`JS filter error for ${href}: ${e}`);return false;}});let paramUrls=allLinks.filter(href=>{try{let url=new URL(href);let hostname=url.hostname.replace(/^www\./,"");return href.includes("?") && !href.match(/\.js/) && (hostname===baseHostname || hostname.endsWith(%27.%27 + baseHostname));}catch(e){return false;}});let domain=baseHostname;scanningDiv.innerHTML=`<div style="display:flex;justify-content:space-between;align-items:center;"><div><a href="data:text/plain;charset=utf-8,${encodeURIComponent([...new Set(resultsInScope)].join(%27\n%27))}" download="url_${domain}_in_scope_map.txt" style="margin-right:10px;padding:10px 20px;background:#2196F3;color:white;text-decoration:none;">Download In Scope</a><a href="data:text/plain;charset=utf-8,${encodeURIComponent([...new Set(resultsSubdomains)].join('\n'))}" download="url_${domain}_subdomains_map.txt" style="margin-right:10px;padding:10px 20px;background:#FF9800;color:white;text-decoration:none;">Download Subdomains</a><a href="data:text/plain;charset=utf-8,${encodeURIComponent([...new Set(resultsOutOfScope)].join('\n'))}" download="url_${domain}_out_scope_map.txt" style="margin-right:10px;padding:10px 20px;background:#9C27B0;color:white;text-decoration:none;">Download Out of Scope</a><a href="data:text/plain;charset=utf-8,${encodeURIComponent([...new Set(jsFiles)].join('\n'))}" download="url_${domain}_js_files_map.txt" style="margin-right:10px;padding:10px 20px;background:#607D8B;color:white;text-decoration:none;">Download JS Files</a><a href="data:text/plain;charset=utf-8,${encodeURIComponent([...new Set(paramUrls)].join('\n'))}" download="url_${domain}_param_urls_map.txt" style="padding:10px 20px;background:#795548;color:white;text-decoration: none;">Download Param URLs</a></div><button onclick="this.parentElement.parentElement.remove();" style="padding:10px 20px;background:#f44336;color:white;border:none;cursor:pointer;">Close</button></div><div style="display:flex;margin-top:10px;"><button onclick="document.querySelectorAll('.tab-content').forEach(t=>t.style.display='none');document.querySelector('#in-scope').style.display='block';this.classList.add('active');document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));" class="tab active" id="in-tab">In Scope (${[...new Set(resultsInScope)].length})</button><button onclick="document.querySelectorAll('.tab-content').forEach(t=>t.style.display='none');document.querySelector('#subdomains').style.display='block';this.classList.add('active');document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));" class="tab" id="sub-tab">Subdomains (${[...new Set(resultsSubdomains)].length})</button><button onclick="document.querySelectorAll('.tab-content').forEach(t=>t.style.display='none');document.querySelector('#out-scope').style.display='block';this.classList.add('active');document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));" class="tab" id="out-tab">Out of Scope (${[...new Set(resultsOutOfScope)].length})</button><button onclick="document.querySelectorAll('.tab-content').forEach(t=>t.style.display='none');document.querySelector('#js-files').style.display='block';this.classList.add('active');document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));" class="tab" id="js-tab">JS Files (${[...new Set(jsFiles)].length})</button><button onclick="document.querySelectorAll('.tab-content').forEach(t=>t.style.display='none');document.querySelector('#param-urls').style.display='block';this.classList.add('active');document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));" class="tab" id="param-tab">Param URLs (${[...new Set(paramUrls)].length})</button></div><ul id="in-scope" class="tab-content" style="display:block;">${[...new Set(resultsInScope)].map(r=>%60<li><a href="${r}" target="_blank">${r}</a></li>%60).join("")}</ul><ul id="subdomains" class="tab-content" style="display:none;">${[...new Set(resultsSubdomains)].map(r=>%60<li><a href="${r}" target="_blank">${r}</a></li>%60).join("")}</ul><ul id="out-scope" class="tab-content" style="display:none;">${[...new Set(resultsOutOfScope)].map(r=>%60<li><a href="${r}" target="_blank">${r}</a></li>%60).join("")}</ul><ul id="js-files" class="tab-content" style="display:none;">${[...new Set(jsFiles)].map(r=>%60<li><a href="${r}" target="_blank">${r}</a></li>%60).join("")}</ul><ul id="param-urls" class="tab-content" style="display:none;">${[...new Set(paramUrls)].map(r=>%60<li><a href="${r}" target="_blank">${r}</a></li>%60).join("")}</ul><style>.tab{margin:0 5px;padding:10px 20px;border:none;background:#f0f0f0;cursor:pointer;font-weight:bold;}.tab.active{background:#4CAF50;color:white;}.tab-content{margin:0;padding:0;}</style>%60;})();
```

## How to use

- Add a new bookmark to your browser's bookmark bar.
- Replace the bookmark's URL with the JavaScript code provided above.
- Visit the target website and click the bookmarklet. The script will run in your browser, recursively collecting information available in the HTML code.

### Notes

- You can modify the `maxLinks=5000` variable in the code to increase or decrease the total number of results.
- Additionally, you can specify other file extensions to exclude from the script's results by editing the regular expression `!href.match(/\.(bmp|ico|css|woff|woff2|webp)/i)`.

## Example Results

![Pasted image 20250615154736](https://github.com/user-attachments/assets/7389aeb6-8870-47c4-b0a9-6cb9beab6dc5)
